// Advent of Code 2024. Day 21
// dotnet fsi aoc21.fsx

open System
open System.IO

let lookupInstructionsNumericKeypad (source, target) = 
    match (source, target) with 
    | ('A', '0') -> ['<']
    | ('A', '1') -> ['^'; '<'; '<']
    | ('A', '2') -> ['^'; '<']
    | ('A', '3') -> ['^']
    | ('A', '4') -> ['^';'^'; '<'; '<']
    | ('A', '5') -> ['^';'^'; '<']
    | ('A', '6') -> ['^';'^']
    | ('A', '7') -> ['^';'^';'^'; '<'; '<']
    | ('A', '8') -> ['^';'^';'^'; '<']
    | ('A', '9') -> ['^';'^';'^']
    | ('0', 'A') -> ['^';'A'] 
    | ('0', '1') -> ['^';'<']
    | ('0', '2') -> ['^']
    | ('0', '3') -> ['^';'>']
    | ('0', '4') -> ['^';'^';'<']
    | ('0', '5') -> ['^';'^']
    | ('0', '6') -> ['^';'^';'>']
    | ('0', '7') -> ['^';'^';'^';'<']
    | ('0', '8') -> ['^';'^';'^']
    | ('0', '9') -> ['^';'^';'^';'>']
    | ('1', 'A') -> ['>';'>';'v';'A']
    | ('1', '0') -> ['>';'v']
    | ('1', '2') -> ['>']
    | ('1', '3') -> ['>';'>']
    | ('1', '4') -> ['^']
    | ('1', '5') -> ['^';'>']
    | ('1', '6') -> ['^';'>';'>']
    | ('1', '7') -> ['^';'^']
    | ('1', '8') -> ['^';'^';'>']
    | ('1', '9') -> ['^';'^';'>';'>']
    | ('2', 'A') -> ['>';'v';'A']
    | ('2', '0') -> ['v']
    | ('2', '1') -> ['<']
    | ('2', '3') -> ['>']
    | ('2', '4') -> ['^';'<']
    | ('2', '5') -> ['^']
    | ('2', '6') -> ['^';'>']
    | ('2', '7') -> ['^';'^';'<']
    | ('2', '8') -> ['^';'^']
    | ('2', '9') -> ['^';'^';'>']
    | ('3', 'A') -> ['v';'A']
    | ('3', '0') -> ['<';'v']
    | ('3', '1') -> ['<';'<']
    | ('3', '2') -> ['<']
    | ('3', '4') -> ['^';'<';'<']
    | ('3', '5') -> ['^';'<']
    | ('3', '6') -> ['^']
    | ('3', '7') -> ['^';'^';'<';'<']
    | ('3', '8') -> ['^';'^';'<']
    | ('3', '9') -> ['^';'^']
    | ('4', 'A') -> ['>';'>';'v';'v';'A']
    | ('4', '0') -> ['>';'v';'v']
    | ('4', '1') -> ['v']
    | ('4', '2') -> ['>';'v']
    | ('4', '3') -> ['>';'>';'v']
    | ('4', '5') -> ['>']
    | ('4', '6') -> ['>';'>']
    | ('4', '7') -> ['^']
    | ('4', '8') -> ['^';'>']
    | ('4', '9') -> ['^';'>';'>']
    | ('5', 'A') -> ['>';'v';'v';'A']
    | ('5', '0') -> ['v';'v']
    | ('5', '1') -> ['<';'v']
    | ('5', '2') -> ['v']
    | ('5', '3') -> ['>';'v']
    | ('5', '4') -> ['<']
    | ('5', '6') -> ['>']
    | ('5', '7') -> ['^';'<']
    | ('5', '8') -> ['^']
    | ('5', '9') -> ['^';'>']
    | ('6', 'A') -> ['v';'v';'A']
    | ('6', '0') -> ['<';'v';'v']
    | ('6', '1') -> ['<';'<';'v']
    | ('6', '2') -> ['<';'v']
    | ('6', '3') -> ['v']
    | ('6', '4') -> ['<';'<']
    | ('6', '5') -> ['<']
    | ('6', '7') -> ['^';'<';'<']
    | ('6', '8') -> ['^';'<']
    | ('6', '9') -> ['^']
    | ('7', 'A') -> ['>';'>';'v';'v';'v';'A']
    | ('7', '0') -> ['>';'v';'v';'v']
    | ('7', '1') -> ['v';'v']
    | ('7', '2') -> ['>';'v';'v']
    | ('7', '3') -> ['>';'>';'v';'v']
    | ('7', '4') -> ['v']
    | ('7', '5') -> ['>';'v']
    | ('7', '6') -> ['>';'>';'v']
    | ('7', '8') -> ['>']
    | ('7', '9') -> ['>';'>']
    | ('8', 'A') -> ['>';'v';'v';'v';'A']
    | ('8', '0') -> ['v';'v';'v']
    | ('8', '1') -> ['<';'v';'v']
    | ('8', '2') -> ['v';'v']
    | ('8', '3') -> ['>';'v';'v']
    | ('8', '4') -> ['<';'v']
    | ('8', '5') -> ['v']
    | ('8', '6') -> ['>';'v']
    | ('8', '7') -> ['<']
    | ('8', '9') -> ['>']
    | ('9', 'A') -> ['v';'v';'v';'A']
    | ('9', '0') -> ['<';'v';'v';'v']
    | ('9', '1') -> ['<';'<';'v';'v']
    | ('9', '2') -> ['<';'v';'v']
    | ('9', '3') -> ['v';'v']
    | ('9', '4') -> ['<';'<';'v']
    | ('9', '5') -> ['<';'v']
    | ('9', '6') -> ['v']
    | ('9', '7') -> ['<';'<']
    | ('9', '8') -> ['<']

let readLines = 
    File.ReadAllLines
    >> Array.filter (fun line -> line <> String.Empty)
    >> Array.toList

let run fileName = 
    let lines = readLines fileName
    lines |> printfn "%A"

run "input"
